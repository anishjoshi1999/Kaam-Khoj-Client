<%- include('./partials/header.ejs') %>

<div style="margin-top: 80px;">
  <div class="container vh-100">
    <h2 class="text-center">Total Records: <%= jobsData.length %></h2>
    <table class="table table-bordered table-hover">
      <thead class="thead-dark">
        <tr>
          <th scope="col">S.N</th>
          <th scope="col">Job Name</th>
          <th scope="col">Salary</th>
          <th scope="col">Job Description</th>
          <th scope="col">Specific Job</th> 
          <th scope="col">Job Seeker / Provider</th>
          <th scope="col">Contact Number</th>
          <th scope="col">Location</th>
          <th scope="col">Availability</th>
          <th scope="col">Created Time</th>
          <th scope="col">Actions</th>
        </tr>
      </thead>
      <tbody>
        <% if (Array.isArray(jobsData) && jobsData.length > 0) { %>
          <% jobsData.forEach((job, index) => { %>
            <tr>
              <td><%= index + 1 %></td>
              <td><%= job.name %></td>
              <td><%= job.salary %></td>
              <td><%= job.description %></td>
              <td><%= job.specificJob.toUpperCase() || "N/A" %>
              <td><%= job.role.toUpperCase() %></td>
              <td><%= job.contactNumber %></td>
              <td><%= job.location %></td>
              <td class="<%= job.availability ? 'bg-success' : 'bg-danger' %> text-white">
                <%= job.availability.toString().toUpperCase() %>
              </td>
              <td><%= job.createdTime.toLocaleString() %></td>
              <td>
                <div class="btn-group">
                  <form action="/api/view/<%=job._id%>" method="GET" style="display: inline;">
                    <!-- Hidden input fields with the job data -->
                    <% Object.entries(job).forEach(([key, value]) => { %>
                      <input type="hidden" name="<%= key %>" value="<%= value %>">
                    <% }) %>
                    <button type="submit" class="btn btn-sm btn-primary mr-1">Edit</button>
                  </form>
                  <form action="/api/delete/<%= job._id %>" method="POST" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete this record?');">
                    <input type="hidden" name="_method" value="DELETE">
                    <button type="submit" class="btn btn-sm btn-danger">Delete</button>
                  </form>
                </div>
              </td>
            </tr>
          <% }) %>
        <% } else { %>
          <tr>
            <td colspan="10" class="text-center">No data available</td>
          </tr>
        <% } %>
      </tbody>
    </table>
  </div>
</div>

<%- include('./partials/footer.ejs') %>
